<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta http-equiv="x-ua-compatible" content="ie=edge">
	<title>Enhancement 6 | Web Backend Development I</title>
	<meta name="description" content="CSE 340 Enhancement 6 directions">
	<meta name="viewport" content="width=device-width">
	<link rel="stylesheet" href="/340br/css/340course.css" media="screen">
</head>

<body>
	<div id="wrapper">
		<header id="header"><img src="/340br/340banner.jpg" alt="CSE 340 Banner Image"></header>
		<main>
			<h1>Enhancement 6</h1>
			<h2>Introduction</h2>
			<p>This week has introduced cookies, sessions and how they work together to maintain "state" as the browser and
				server interact. This is an absolute requirement to login a site visitor. As you went through the login process
				it should be obvious that we left some things undone.</p>

			<h2>Overview</h2>
			<p>In this enhancement you will:</p>
			<ol>
				<li>add a client <b>admin.php</b> view that will be the landing page when a client logs in, and</li>
				<li>use the session to make sure the visitor is "logged in" in order to see the view, and</li>
				<li>extract data from the session to display content in the <b>admin.php</b> view, and</li>
				<li>replace the cookie welcome message, with a session-based welcome message using the first name of the
					logged-in client following login (this must appear in all views while the client is logged in), and</li>
				<li>add a link to the welcome message that will allow the logged in client to click it to be directed to the
					client admin view through the controller, and</li>
				<li>add a new registrant to the client's table and change the clientLevel of the new registrant, and </li>
				<li>add additional capability to the <b>admin.php</b> view to show a link to the vehicle controller but only if
					the logged in visitor has a clientLevel greater than "1" (the default for all new registered site visitors),
					and</li>
				<li>create a "logout" process and add it to the PHP Motors web site.</li>
			</ol>
			<h2>Video Overview</h2>
			<p>This short video demonstrates what the finished enhancement will look like and the functionality it should
				possess.</p>
			<iframe width="560" height="315" src="https://www.youtube.com/embed/GZdQFudgzN4" title="YouTube video player"
				frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
				allowfullscreen></iframe>

			<h2>For Your Information</h2>
			<p>The "firstname" cookie that was set to display in the "login" activity is completely independent of the Login -
				Logout process. When a client "logs in" or "logs out" the cookie remains. Do not let the fact that the "Welcome"
				message from the cookie appears after registration and prior to login interfere with your understanding of the
				login - logout process.</p>

			<h2>Tasks</h2>
			<p>As described above you are being asked to add a new view and then add functionality to the view based on the
				site visitor who is logged in. Then, add a logout process to the site.</p>

			<h3>Create the View</h3>
			<ol>
				<li>Use your PHP Motors template to create a new view in the "<b>view</b>" folder named "<b>admin.php</b>".</li>
				<li>Add a PHP code block to the top of the view (before the doctype declaration) but make sure there are no
					empty spaces or lines between the end of the PHP code block and the start of the doctype declaration!</li>
				<li>Add code to the default case statement in the accounts controller that will deliver the admin.php view.</li>
			</ol>

			<h3>Check for Login</h3>
			<ol>
				<li>In the PHP code block at the top of the admin.php view, write an <code>if()</code> test to see if the
					visitor is NOT logged in. If the visitor is NOT logged in, use a header function to send them to the main PHP
					Motors controller in order for the PHP Motors home view to be delivered.</li>
			</ol>

			<h3>Display SESSION data</h3>
			<ol>
				<li>Assuming the site visitor is "logged in", then in the <code>&lt;main&gt;</code> element create an
					<code>&lt;h1&gt;</code> element and display the "logged in" user's full name.</li>
				<li>Below the <code>&lt;h1&gt;</code> create an unordered list. In each list item display the user's data that
					has been stored into the session, preceeded by a meaningful label (e.g. First name: Bill, Email Address:
					wildbill@ok.com, etc...).</li>
			</ol>

			<h3>Replace the Welcome Message</h3>
			<ol>
				<li>Replace the cookie-welcome message with a session-based welcome message.</li>
				<li>The new welcome message (e.g. "Welcome Susan") must take the firstname value from the session following
					login.</li>
				<li>The welcome message must appear in all views, throughout the site, while the client is logged in.</li>
				<li>When a client logs out, the welcome message will be removed completely.</li>
			</ol>

			<h3>Welcome Message Link</h3>
			<ol>
				<li>After the client logs in and the session-based welcome message is working turn it into a link.</li>
				<li>The link, when clicked, should direct to the accounts controller and deliver the client admin view.</li>
				<li>When the client logs out, the link should be unreachable as the welcome message is removed from all views.
				</li>
			</ol>

			<h3>Register a New Client</h3>
			<ol>
				<li>Register the following new client to the database:
					<ul>
						<li>Firstname: <b>Admin</b></li>
						<li>Lastname: <b>User</b></li>
						<li>Email: <b>admin@cse340.net</b></li>
						<li>Password: <b>Sup3rU$er</b></li>
					</ul>
				</li>
				<li>Using PHPMyAdmin, change the clientLevel for the new record to "3".</li>
			</ol>

			<h3>Additional View Functionality</h3>
			<ol>
				<li>Return to the <b>admin.php</b> view.</li>
				<li>Below the unordered list write a test to determine if the clientLevel of the logged in client is greater
					than 1.</li>
				<li>If the level is greater than 1 display a paragraph with a link inside that points to the vehicle controller.
				</li>
				<li>If the level is equal to 1, then the paragraph and link should not be built into the view by the server.
					This means that if the view is sent to the browser and you do a "view page source" the paragraph html is not
					present.</li>
			</ol>

			<h3>Logout Process</h3>
			<ol>
				<li>In the accounts controller add a new case statement to watch for a "Logout" value.</li>
				<li>If a "Logout" is received then the session data should be unset (hint, hint) and the session destroyed
					(hint, hint) and the client is returned to the main phpmotors controller.</li>
				<li>To enable this logout process to happen, code will have to be added to the views to accomplish the
					following:
					<ul>
						<li>If a site visitor (the client) is not logged in, the "My Account" link should be present and operational
							(as it currently exists).</li>
						<li>When the client is "logged in" the "My Account" link should be replaced with a "Log out" link that
							points to the accounts controller and passes the appropriate name value pair to trigger the logout event.
						</li>
						<li>This code area can also be where the welcome message and link are displayed or hidden.</li>
					</ul>
				</li>
			</ol>

			<h3>Extra Credit Code</h3>
			<p>For 5 points of extra credit, add code to each of the "vehicle" views (vehicle management, new vehicle and new
				classification) that checks that a client is "loggedin" AND has a clientLevel greater than "1" to access the
				view. If not, redirect the client back to the phpmotors controller to deliver the PHP Motors home view.</p>

			<h2>Test, Test, Test</h2>
			<p>Be sure to complete all tasks and then test that they work.</p>
			<ul>
				<li>Attempt to access the <b>admin.php</b> view directly before logging in. It should deny you access and
					redirect you to the phpmotors controller, which should deliver the home view by default.</li>
				<li>Make sure the "My Account" link appears prior to login, and that the "Logout" link and welcome message, with
					its link, appears after logging in.</li>
				<li>Click the welcome message link to ensure that the client admin view is deliverd via the accounts controller.
				</li>
				<li>Log in as a level "1" user to test that the data appears in the "<b>admin.php</b>" view, but that the link
					to the vehicle management view does not.</li>
				<li>Logout as the level "1" user and log in as the level "3" user. When you view the <b>admin.php</b> view, your
					own data should appear as well as the link to the vehicle management view. Test the link to make sure it takes
					you to the vehicle controller, which should deliver the vehicles admin view by default.</li>
			</ul>


			<h2>Submission</h2>
			<ul>
				<li>Work with your learning team to accomplish the tasks and post to and read the weekly discussion board to
					help one another.</li>
				<li>Build, run and test to make sure that each of the tasks works.</li>
				<li>When satisfied that the code is operational:
					<ol>
						<li>Create a video showing each of the items listed in Objective 6 of the grading matrix below.
						</li>
						<li>Post your video to your YouTube channel as "Unlisted" and copy the link to the video when published.
						</li>
						<li>Zip the entire phpmotors folder and name it enhancement 6 (save this zip file outside of
							your web site).</li>
						<li>Submit the zip file to the enhancement 6 assignment dropbox and add the video URL to the
							assignment dropbox comment.</li>
					</ol>
				</li>
			</ul>

			<h2>Grading Matrix</h2>
			<p>It is impossible, or impractical, to list everything that should be present in developing any web application. For
				this course, the guiding principle for all work should be, "The process works while following best practice and the
				concepts described in the course materials and activities".</p>
			<p>The items below represent key items used for grading, but the professor has the right to alter the criteria and
				point values if best practice or key concepts from the course materials are missing from the submitted solution.
			</p>
			<p>This enhancement has values in multiple objectives as shown below:</p>
			<h3>Objective 1</h3>
			<ul>
				<li>The <mark>admin.php</mark> view meets the standards shown in the <a
						href="https://blainerobertson.github.io/340br/phpmotors/views/dev-checklist.html"
						title="Open the web development checklist in a new tab" target="_blank">Frontend Checklist</a></li>
				<li>Total value for Objective 1: <b>5 points</b></li>
			</ul>

			<h3>Objective 2</h3>
			<ul>
				<li>The code to switch the "My Accounts" and "Logout" links is present and works in all views.</li>
				<li>The welcome message, as a link, appears while logged in and does not following logout in all views.</li>
				<li>The welcome message link returns the client to the client admin view when clicked from any view.</li>
				<li>The login process is present in the accounts controller and works.</li>
				<li>The logout process is present in the accounts controller and works.</li>
				<li>The code to check for being logged in is present and works in the "admin.php" view.</li>
				<li>The code to display the "vehicles management" link in the "admin.php" view is present and works only if the
					logged in client has a clientLevel greater than "1".</li>
				<li>Total value for Objective 2: <b>20 points</b></li>
			</ul>

			<h3>Objective 6</h3>
			<ul>
				<li>The video URL is present and the video is narrated by you using your own voice. The video shows:
					<ul>
						<li>The "my account" link is present before login and the "Logout" link appears after login; show this
							functionality in multiple views.</li>
						<li>The welcome message, with the logged-in client's firstname appears in all views following login and is
							removed following logout.</li>
						<li>The welcome message link works to return the client to the client admin view when clicked from multiple
							views.</li>
						<li>Logging in as a level "1" user and the displaying of the client data in the "<b>admin.php</b>" view.
						</li>
						<li>The "<mark>admin.php</mark>" view meets the standards shown in the <a
								href="https://blainerobertson.github.io/340br/phpmotors/views/dev-checklist.html"
								title="Open the web development checklist in a new tab" target="_blank">Frontend Checklist</a></li>
						<li>Logging out.</li>
						<li>Logging in as a level "3" user and the appearance of the Vehicles link.</li>
						<li>Clicking the Vehicles link to show that the vehicles management view is delivered.</li>
						<li>If you did the extra credit, it must be shown in the video to receive credit. Be sure to mention that
							you are demonstrating the extra credit during the video.</li>
					</ul>
				</li>
				<li>Total value for Objective 6: <b>5 points</b></li>
			</ul>

			<h3>Extra Credit</h3>
			<ul>
				<li>Code exists in each of the "vehicle" views (vehicle management, new vehicle and new classification) that
					checks that a client is both "loggedin" AND has a clientLevel greater than "1" to access the view. If not, the
					client is redirected to the phpmotors controller to deliver the PHP Motors home view.</li>
				<li>5 points extra credit if present and operational.</li>
			</ul>
		</main>
	</div>
</body>

</html>